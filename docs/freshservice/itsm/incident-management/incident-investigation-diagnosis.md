---
sidebar_position: 4
---

# 인시던트 조사 및 진단

체계적인 인시던트 조사와 정확한 진단은 근본 원인을 파악하고 효과적인 해결 방안을 도출하는 핵심 프로세스입니다.

:::info 인시던트 조사 시작 전 필수 확인사항
- **조사 범위 정의**: 인시던트 영향 범위와 관련 시스템 의존성 사전 파악 필요
- **증거 보전**: 로그 파일, 시스템 상태 정보 등 조사 증거 즉시 백업 필수
- **조사팀 구성**: 기술 전문성과 비즈니스 이해도를 갖춘 적절한 인력 배정 필요
- **시간 관리**: 조사 시간과 복구 우선순위 간의 균형점 사전 설정 권장
:::

## 체계적 조사 방법론

### 5W1H 조사 프레임워크

모든 인시던트 조사는 체계적인 질문을 통해 정확한 상황 파악을 수행합니다.

**핵심 조사 요소**:

| 요소 | 질문 | 확인 방법 | 중요도 |
|------|------|-----------|--------|
| **What (무엇)** | 정확히 무엇이 발생했는가? | 증상, 오류 메시지, 로그 분석 | 필수 |
| **When (언제)** | 언제부터 발생했는가? | 타임스탬프, 모니터링 데이터 | 필수 |
| **Where (어디서)** | 어느 시스템/위치에서 발생했는가? | 네트워크 토폴로지, 시스템 맵 | 필수 |
| **Who (누가)** | 누가 영향을 받았는가? | 사용자 그룹, 접근 로그 | 중요 |
| **Why (왜)** | 왜 발생했는가? (근본 원인) | 상세 분석, RCA | 필수 |
| **How (어떻게)** | 어떻게 해결할 것인가? | 해결 계획, 테스트 방법 | 필수 |

### 계층적 조사 접근법

**Layer 1: 사용자 경험 계층**
- 사용자가 체감하는 증상 파악
- 업무 프로세스 영향 범위 확인
- 워크어라운드 가능성 평가

**Layer 2: 애플리케이션 계층**
- 애플리케이션 로그 분석
- 데이터베이스 성능 확인
- API 호출 및 응답 검증

**Layer 3: 인프라 계층**
- 서버 리소스 상태 점검
- 네트워크 연결성 확인
- 스토리지 및 백업 상태 검증

**Layer 4: 환경/외부 요인**
- 외부 서비스 의존성 확인
- 환경 변화 (배포, 설정 변경) 점검
- 물리적 환경 요인 (전력, 온도 등)

:::tip 효과적인 조사를 위한 모범사례
**병렬 조사 수행**:
- 여러 계층을 동시에 조사하여 시간 단축
- 팀원별 전문 영역 분담으로 효율성 극대화
- 정기적 상황 공유로 조사 방향성 조정
:::

## 진단 도구 및 로그 분석

### 시스템 진단 도구

**Windows 환경**:
```powershell
# 시스템 리소스 확인
Get-Counter "\Processor(_Total)\% Processor Time"
Get-Counter "\Memory\Available MBytes"
Get-WmiObject -Class Win32_LogicalDisk

# 네트워크 연결 확인
Test-NetConnection -ComputerName target-server -Port 80
Get-NetAdapter | Where-Object Status -eq "Up"

# 서비스 상태 확인
Get-Service | Where-Object Status -eq "Stopped"
Get-EventLog -LogName System -Newest 100
```

**Linux 환경**:
```bash
# 시스템 리소스 확인
top -bn1 | grep "Cpu(s)"
free -h
df -h

# 네트워크 진단
netstat -tuln | grep :80
ping -c 4 target-server
traceroute target-server

# 로그 분석
tail -f /var/log/syslog
journalctl -u service-name -f
```

### 로그 분석 방법론

**1단계: 로그 수집 및 시간 동기화**
```markdown
로그 수집 체크리스트:
✅ 애플리케이션 로그 (application.log)
✅ 시스템 로그 (syslog, event log)
✅ 웹서버 로그 (access.log, error.log)
✅ 데이터베이스 로그 (slow query, error log)
✅ 네트워크 장비 로그 (switch, router, firewall)
```

**2단계: 패턴 분석 및 이상 징후 탐지**
- 오류 메시지 빈도 분석
- 응답 시간 추이 확인
- 리소스 사용률 변화 패턴
- 동시 접속자 수 변화

**3단계: 상관관계 분석**
- 시간대별 이벤트 연관성 분석
- 시스템 간 의존성 추적
- 외부 요인과의 상관관계 확인

:::warning 로그 분석 시 주의사항
- **개인정보 보호**: 로그에 포함된 민감 정보 마스킹 처리
- **로그 무결성**: 조사 과정에서 원본 로그 변경 방지
- **법적 증거력**: 필요시 법적 증거로 활용 가능한 형태로 보관
:::

## 임시 해결책 적용 가이드

### 워크어라운드 전략

**즉시 적용 가능한 임시 조치**:

1. **서비스 우회 (Service Bypass)**
   - 적용 상황: 특정 기능 오류 시
   - 방법: 문제 기능 비활성화, 대체 경로 제공
   - 예시: 결제 시스템 오류 → 수동 결제 처리 안내

2. **로드 밸런싱 조정**
   - 적용 상황: 특정 서버 성능 문제 시
   - 방법: 트래픽을 정상 서버로 재분산
   - 예시: 웹서버 1대 과부하 → 다른 서버로 트래픽 이동

3. **서비스 품질 저하 승인**
   - 적용 상황: 완전 복구 시간이 긴 경우
   - 방법: 제한된 기능으로 서비스 유지
   - 예시: 검색 기능 제한하여 핵심 기능 안정성 확보

:::success 임시 조치 효과
적절한 워크어라운드 적용 시 사용자 영향 70% 이상 감소, 비즈니스 연속성 확보 가능
:::

## 실무 활용 예시

### 상황 1: 데이터베이스 응답 지연 조사

**목표**: 데이터베이스 성능 저하의 근본 원인 파악 및 신속한 복구

**조사 과정**:
1. **증상 확인 (5분)**
   - 웹 애플리케이션 응답 시간 3배 증가
   - 데이터베이스 연결 시간 초과 오류 발생
   - 사용자 로그인 및 조회 기능 영향

2. **1차 진단 (15분)**
   ```sql
   -- 실행 중인 쿼리 확인
   SHOW PROCESSLIST;
   
   -- 느린 쿼리 분석
   SELECT * FROM mysql.slow_log 
   WHERE start_time > '2024-01-01 10:00:00';
   
   -- 리소스 사용률 확인
   SHOW ENGINE INNODB STATUS;
   ```

3. **근본 원인 발견**
   - 정기 리포트 생성 배치 작업이 대용량 테이블 스캔 수행
   - 인덱스 미적용으로 인한 풀 테이블 스캔 발생
   - 메모리 버퍼 풀 용량 부족

**결과**: 배치 작업 중단 후 응답시간 정상화, 인덱스 추가로 재발 방지

### 상황 2: 네트워크 연결 불안정 조사

**목표**: 간헐적 네트워크 끊김 현상의 원인 파악 및 해결

**방법**:
1. **패턴 분석 (20분)**
   - 특정 시간대 (오후 2-4시) 집중 발생
   - 특정 VLAN (개발팀 네트워크) 한정
   - 외부 인터넷 접속은 정상

2. **네트워크 경로 추적**
   ```bash
   # 네트워크 홉별 지연시간 확인
   mtr -r -c 100 target-server
   
   # 스위치 포트 상태 확인
   show interface status
   
   # 트래픽 패턴 분석
   netstat -i 5
   ```

3. **근본 원인 발견**
   - 스위치 포트 duplex mismatch 발생
   - 오후 시간대 트래픽 증가로 문제 표면화
   - 자동 협상 설정 오류

**결과**: 스위치 포트 설정 수동 조정, 네트워크 설정 표준화 가이드 수립

### 상황 3: 애플리케이션 메모리 누수 조사

**목표**: 서버 재시작이 반복되는 메모리 누수 문제의 근본 원인 규명

**방법**:
1. **메모리 사용 패턴 분석 (30분)**
   ```bash
   # 메모리 사용률 추이 확인
   sar -r 1 600
   
   # 프로세스별 메모리 사용량
   ps aux --sort=-%mem | head
   
   # 가비지 컬렉션 로그 분석
   tail -f gc.log
   ```

2. **애플리케이션 프로파일링**
   - 힙 덤프 분석으로 메모리 누수 지점 특정
   - 메모리 할당 패턴 추적
   - 객체 참조 관계 분석

**결과**: 문제 코드 수정 및 긴급 패치 배포, 메모리 모니터링 강화

## 성과 측정 및 개선

### 조사 효율성 지표

| 지표명 | 목표 수치 | 측정 방법 | 현재 달성도 |
|--------|-----------|-----------|-------------|
| **평균 조사 시간** | < 2시간 | 조사 시작 ~ 근본 원인 파악 | 1.8시간 |
| **근본 원인 정확도** | > 95% | 재발 여부로 검증 | 92% |
| **임시 조치 효과** | > 80% | 사용자 영향 감소율 | 78% |
| **조사 완료율** | > 98% | 조사 완료 / 전체 인시던트 | 96% |

## 문제 해결 가이드

### 자주 발생하는 조사 중 문제들

#### 문제: 조사에 필요한 로그가 이미 삭제됨

**원인**: 로그 보관 정책 부재 또는 저장 공간 부족으로 인한 자동 삭제

**해결**:
1. **로그 보관 정책 수립**
   - 인시던트 유형별 필수 로그 정의
   - 최소 보관 기간 설정 (일반: 30일, 중요: 90일)
   - 자동 아카이빙 시스템 구축

2. **실시간 로그 백업**
   - 인시던트 발생 즉시 관련 로그 보존
   - 클라우드 스토리지 활용 장기 보관
   - 압축 및 암호화 적용

#### 문제: 조사팀원 간 중복 작업 및 비효율

**원인**: 역할 분담 미흡 및 진행 상황 공유 부족

**해결**:
1. **명확한 역할 분담**
   - 조사 리더 지정 및 책임 영역 명시
   - 기술 영역별 담당자 사전 배정
   - 커뮤니케이션 채널 및 보고 체계 구축

2. **실시간 협업 도구 활용**
   - 공유 문서를 통한 실시간 진행 상황 업데이트
   - 화상회의 및 메신저를 통한 즉시 소통
   - 조사 체크리스트 및 템플릿 활용

:::warning 조사 및 진단 시 주의사항
- **시간 제한 고려**: 완벽한 조사보다 신속한 복구가 우선인 경우 구분
- **보안 정보 취급**: 조사 과정에서 노출되는 민감 정보 보호 철저
- **변경 최소화**: 조사를 위한 시스템 변경이 추가 문제를 야기하지 않도록 주의
:::

## 관련 기능 및 연계

인시던트 조사 및 진단과 연계되는 핵심 프로세스들:

- **[인시던트 탐지 및 로깅](./incident-detection-logging/)**: 조사의 기초가 되는 정확한 데이터 수집
- **[인시던트 해결 및 복구](./incident-resolution-recovery/)**: 조사 결과를 바탕으로 한 효과적 해결 실행
- **[인시던트 종료 및 검토](./incident-closure-review/)**: 조사 과정의 검증 및 개선점 도출
- **[주요 인시던트 관리](./major-incident-management/)**: 대규모 인시던트의 심화 조사 및 진단